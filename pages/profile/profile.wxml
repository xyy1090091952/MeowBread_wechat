<!--pages/profile/profile.wxml-->
<view class="container">
  <view class="user-info">
    <!-- 未登录时显示 -->
    <block wx:if="{{!isLoggedIn}}">
      <image class="avatar" src="{{avatarUrl || '/images/icons/profile.png'}}"></image>
      <button open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar" class="avatar-button"> 选择头像 </button>
      <input type="nickname" class="nickname-input" placeholder="请输入昵称" bind:blur="onNicknameInput" value="{{nickname}}"/>
      <button bindtap="login" class="login-button">保存并登录</button>
    </block>
    <!-- 登录后显示 -->
    <block wx:if="{{isLoggedIn && userInfo}}">
      <image class="avatar" src="{{userInfo.avatarUrl}}"></image>
      <text class="nickname">{{userInfo.nickName}}</text>
      <button bindtap="logout">退出登录</button>
    </block>
  </view>
  <view class="statistics" wx:if="{{isLoggedIn}}">
    <text class="stat-title">答题统计</text>
    <view class="stat-item">总题数：{{statistics.totalQuestions}}</view>
    <view class="stat-item">正确答案：{{statistics.correctAnswers}}</view>
    <view class="stat-item">平均正确率：{{statistics.averageAccuracy}}%</view>
  </view>
  <view class="mistakes" wx:if="{{isLoggedIn}}">
    <text class="mistake-title">错题库</text>
    <view class="mistake-item" wx:for="{{mistakes}}" wx:key="index">
      <text>{{item.word}} - {{item.meaning}}</text>
    </view>
  </view>
</view>
