<!--pages/gashapon/gashapon.wxml-->
<view class="gashapon-container">

  <!-- 金币显示 -->
  <view class="coin-display" style="top: {{statusBarHeight + navBarHeight + 16}}px;">
    <image class="coin-icon-display" src="/images/icons/Coins.png"></image>
    <text class="coin-text">{{userCoins}}</text>
  </view>

  <!-- 自定义导航栏 -->
  <view class="custom-nav" style="height: {{navBarHeight}}px; padding-top: {{statusBarHeight}}px;">
    <image class="nav-back-icon" src="/images/icons/normal_arrow.svg" bindtap="onBack"></image>
    <view class="nav-title">{{pageTitle}}</view>
  </view>

  <!-- 右侧功能按钮 -->
  <view class="side-buttons" style="top: {{menuButtonTop}}px;">
    <view class="side-button" bindtap="onInventory">
      <text>库存</text>
    </view>
    <view class="side-button" bindtap="onRedeem">
      <text>兑换</text>
    </view>
  </view>

  <!-- 扭蛋机主体 -->
  <image class="gashapon-machine" src="/images/gashapon/gashapon_machine.png" mode="widthFix"></image>

  <!-- 底部操作区域 -->
  <view class="bottom-sheet">
    <!-- 选择tag -->
    <view class="sheet-header">
      <view class="series-tags">
        <view class="series-tag {{currentSeriesId === 1 ? 'active' : ''}}" bindtap="onSelectSeries" data-id="1">
          <text>特效扭蛋</text>
        </view>
        <view class="series-tag {{currentSeriesId === 2 ? 'active' : ''}}" bindtap="onSelectSeries" data-id="2">
          <text>人类口粮</text>
        </view>
      </view>
      <!-- 滑动横条指示器 -->
      <view class="tag-indicator" style="left: calc({{currentSeriesId === 1 ? '25% - 64rpx + 24rpx' : '75% - 64rpx - 24rpx'}})"></view>
    </view>

    <!-- 纯视觉展示区域 -->
    <view class="visual-display">
      <block wx:for="{{seriesList}}" wx:key="id">
        <image class="display-card {{item.id === currentSeriesId ? 'show bounce-in' : 'hide'}}" wx:if="{{item.id === currentSeriesId}}" src="{{item.id === 2 ? '/images/gashapon/enegy.png' : '/images/gashapon/magic.png'}}" mode="scaleToFill"></image>
      </block>
    </view>

    <!-- 抽奖按钮 -->
    <view class="draw-button" bindtap="onDraw">
      <image class="coin-icon" src="/images/icons/Coins.png"></image>
      <text>80 抽一次</text>
    </view>
  </view>
</view>