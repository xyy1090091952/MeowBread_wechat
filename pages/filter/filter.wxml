<!--pages/filter/filter.wxml-->
<textbook-selector
  visible="{{isSelectorVisible}}"
  bind:select="onConfirmTextbook"
  bind:close="onCancelTextbook"
/>
<question-type-popup
  visible="{{isQuestionTypePopupVisible}}"
  questionTypeOptions="{{questionTypeOptions}}"
  bind:close="onCloseQuestionTypePopup"
  bind:confirm="onConfirmQuestionTypePopup"
/>
<view class="page-container">
  <view class="section-card" bindtap="showQuestionTypePopup">
    <view class="section-title">题型选择</view>
    <view class="filter-item">
      <view class="filter-item-label">当前已选 {{selectedQuestionTypes.length}} 种</view>
      <image class="picker-arrow" src="/images/icons/change.png" />
    </view>
  </view>

  <view class="section-card">
    <view class="section-title">词库选择</view>
    <view class="filter-item">
      <view class="filter-item-label">选择教材：</view>
      <view class="picker-display" bindtap="showTextbookSelector">
        {{dictionaries[selectedDictionaryIndex].name || '请选择教材'}}
        <image class="picker-arrow" src="/images/icons/change.png" />
      </view>
    </view>

    <view class="filter-item-column">
      <view class="filter-item-label">选择课程：</view>
      <view class="lesson-checkbox-group">
        <label class="lesson-checkbox-item" wx:for="{{lessons}}" wx:key="file" catch:tap="onLessonCheckboxChange" data-file="{{item.file}}">
          <checkbox value="{{item.file}}" checked="{{item.checked}}" />
          <text>{{item.name}}</text>
        </label>
      </view>
    </view>
  </view>

  <button class="confirm-button" type="primary" bindtap="startQuiz" disabled="{{selectedLessonFiles.length === 0}}">完成选择</button>
</view>