# 扭蛋机功能产品需求文档 (PRD)

## 1. 文档信息

| 版本 | 日期       | 作者 | 变更内容 |
| ---- | ---------- | ---- | -------- |
| V1.0 | 2023-07-11 | Gemini | 初稿创建 |
| V1.1 | (日期)     | (姓名) | (更新内容) |

## 2. 项目背景与目标

### 2.1. 背景
为了提升用户粘性和应用的趣味性，我们计划引入游戏化的激励系统。"喵呜面包"作为一款学习应用，在核心的学习功能之外，增加扭蛋机系统可以使用户在学习过程中获得即时奖励和长期收集目标，从而提高用户的活跃度和留存率。

### 2.2. 目标
*   **提升用户参与度:** 通过完成答题任务获取金币，激励用户更频繁地使用核心学习功能。
*   **增强应用趣味性:** 引入收集和随机性元素，为用户提供学习之外的娱乐体验。
*   **建立正向反馈循环:** 用户学习 -> 获得金币 -> 抽取奖励 -> 使用奖励获得个性化装扮 -> 激励用户继续学习。

## 3. 功能范围 (Scope)

### 3.1. 一期功能 (In Scope)
*   扭蛋机主页面，包含待机动画和各功能入口。
*   三个不同主题的扭蛋系列及对应的18种奖品。
*   完整的抽奖流程，包括抽奖动画和结果展示。
*   金币系统，包括答题获取和兑换码兑换功能。
*   库存页面，用于展示和管理用户已获得的奖品。

### 3.2. 暂不包含 (Out of Scope)
*   奖品的社交分享功能。
*   付费购买金币功能。
*   限时活动扭蛋系列。
*   奖品的使用（装饰物替换功能），此部分将作为二期开发。

## 4. 功能详述

### 4.1. 扭蛋机主页

*   **UI & 交互:**
    *   **待机动画:** 页面中央展示一个富有吸引力的、循环播放的扭蛋机待机动画。
    *   **系列选择:** 清晰展示三个扭蛋系列，用户可以左右滑动或点击进行切换选择。
    *   **抽奖按钮:** 每个系列下方有明确的抽奖按钮，显示抽奖所需金币数量（例如：10金币/次）。
    *   **金币余额:** 页面顶部或角落显示用户当前的金币余额。
    *   **功能入口:**
        *   **库存:** 右上角设置“我的库存”或图标按钮，点击后跳转至库存页面。
        *   **金币兑换:** 设置一个不显眼的入口（如“+”号或“兑换”文字链），点击后弹出兑换码输入框。

### 4.2. 扭蛋系列与奖品

共设计三个系列，每个系列包含6个独立的奖品，总计18个。

| 系列名称 | 奖品列表 (示例) |
| :--- | :--- |
| **特效扭蛋** | 樱花雨, 星星闪烁, 彩虹桥, ... (共6款) |
| **人类口粮** | 大汉堡, 披萨, 甜甜圈, ... (共6款) |
| **猫咪口粮** | 猫罐头, 小鱼干, 猫抓板, ... (共6款) |

*   **奖品稀有度 (Rarity):**
    每个系列内的6个奖品，按照稀有度分为三档：
    *   **SSR (超稀有):** 1款
    *   **SR (稀有):** 2款
    *   **R (普通):** 3款

### 4.3. 抽奖逻辑与概率

*   **抽奖消耗:** 每次抽奖消耗特定数量的金币（暂定10个）。
*   **抽奖概率 (建议):**
    > **产品建议:** 原PRD中SSR概率(20%)过高，可能导致用户过快集齐，降低长期吸引力。建议调整为更符合常规游戏设计的概率模型，以增加稀有物品的价值感。

| 稀有度 | 建议抽取概率 |
| :--- | :--- |
| SSR | 5% |
| SR | 25% |
| R | 70% |

*   **防重复机制:** 在**单个**扭蛋系列内，用户**不会抽到已经拥有的奖品**。当一个系列全部集齐后，该系列的抽奖按钮可以置灰或提示“已集齐”。

### 4.4. 抽奖动画与结果页

*   **流程:**
    1.  用户在主页点击“抽奖”按钮。
    2.  若金币充足，扣除金币，播放一段1-3秒的扭蛋机出奖动画。
    3.  动画结束，跳转到结果页。
*   **结果页:**
    *   **奖品展示:** 页面中央突出展示本次抽到的奖品图片和名称。
    *   **稀有度标识:** 明确标出奖品的稀有度（如SSR/SR/R）。
    *   **操作按钮:**
        *   **再抽一次:** 如果金币仍足够，显示此按钮。
        *   **返回首页/完成:** 返回扭蛋机主页。
        *   **立即使用:** (二期功能) 点击后可将装饰物应用到指定场景。一期可先置灰或隐藏。

### 4.5. 金币系统

*   **金币获取:**
    1.  **答题奖励:** 在所有答题模式中，每正确回答一题，奖励1个金币。跳过或答错的题目不奖励。
    2.  **结果页改造:** 在答题结果页，需要新增一个字段，明确展示“本次学习获得 X 金币”。
    3.  **无尽模式改造:** 当用户在无尽模式中途退出时（例如点击左上角返回），应弹窗确认：“是否结束本次无尽模式练习？”，如果确认，则跳转到结果页进行结算和金币发放。
*   **金币兑换:**
    *   在扭蛋机主页提供入口，点击后弹出输入框。
    *   输入有效的兑换码，即可增加对应数量的金币。此功能主要用于运营活动和内部测试。

### 4.6. 库存页面

*   **入口:** 从扭蛋机主页点击“库存”按钮进入。
*   **UI & 交互:**
    *   采用网格（Grid）布局，清晰地展示所有已获得的奖品。
    *   每个奖品以卡片形式展示，包含图片、名称和稀有度。
    *   可以按系列进行tab切换或筛选，方便用户查看不同系列的收集进度。
    *   未获得的奖品可以显示为灰色剪影，并提示“尚未获得”。

## 5. 数据设计 (建议)

为了支持以上功能，建议在数据库中设计以下数据结构：

*   **用户表 (Users):**
    *   `userId` (主键)
    *   `coins` (数值型): 用户持有的金币数量

*   **用户库存表 (UserInventory):**
    *   `inventoryId` (主键)
    *   `userId` (外键, 关联用户)
    *   `itemId` (外键, 关联奖品)
    *   `acquiredDate` (日期): 获得日期

*   **奖品表 (Items):**
    *   `itemId` (主键)
    *   `itemName` (字符串): 奖品名称
    *   `series` (字符串): 所属系列 (e.g., 'special_effects', 'human_food')
    *   `rarity` (字符串): 稀有度 (e.g., 'SSR', 'SR', 'R')
    *   `imageUrl` (字符串): 奖品图片URL

## 6. 开发计划 (建议)

建议将开发过程拆分为以下几个阶段：

*   **阶段一: 静态页面与组件开发 (前端)**
    *   开发扭蛋机主页、结果页、库存页的静态WXML和WXSS。
    *   创建奖品卡片、系列选择器等可复用组件。
*   **阶段二: 核心逻辑开发 (前端)**
    *   实现前端的抽奖动画、页面跳转逻辑。
    *   实现金币兑换码的前端校验和弹窗。
*   **阶段三: 后端与数据集成 (后端 & 前后端联调)**
    *   设计并实现数据库表结构。
    *   开发金币增减、抽奖、库存查询等核心API。
    *   前后端联调，将页面与真实数据打通。
*   **阶段四: 功能整合与改造 (前端)**
    *   改造答题及结果页，加入金币奖励逻辑。
    *   完成无尽模式的退出结算功能。
*   **阶段五: 测试与上线**
    *   功能测试、性能测试、UI验收。
    *   发布上线。